# Задание 1 ----

set.seed(123) # Фиксируем случайные значения для повторяемости эксперимента

# Задаем параметры
r <- 0.01  # Процентная ставка по депозиту
N <- 200   # Количество периодов, которые будем рассматривать
B0 <- 1    # Начальная сумма на банковском счете

# Инициализируем вектор для хранения последовательности Bn
B <- numeric(N + 1)  # Вектор длины N+1, потому что начинаем с B0
B[1] <- B0           # Первое значение - это наш начальный капитал

# Рассчитываем значения банковского счета для каждого периода
for (n in 2:(N + 1)) {
  B[n] <- (1 + r) * B[n - 1]  # Формула для последовательности Bn
}

# Построим график изменения Bn
plot(0:N, B, type = "l", col = "blue", lwd = 2,
     xlab = "Период n", ylab = "Значение Bn",
     main = "Изменение банковского счета при r = 0.01")
grid()  # Добавляем сетку для наглядности

# Задание 2 ----

# Параметры для процесса акций
a <- -0.3  # Один из возможных доходов
b <- 0.8   # Другой возможный доход
p <- 0.4   # Вероятность положительного дохода
S0 <- 1    # Начальная цена акции

# Инициализируем вектор для последовательности S_n
S <- numeric(N + 1)  # Вектор для хранения значений S_n
S[1] <- S0           # Начальная цена акции

# Генерируем последовательность случайных доходностей rho_n
rho <- numeric(N)  # Вектор для хранения случайных величин

for (n in 1:N) {
  # Реализуем Бернуллиевскую случайную величину
  if (rbinom(1, 1, p) == 1) {
    rho[n] <- b  # Если успех, то доходность b
  } else {
    rho[n] <- a  # Если не успех, то доходность a
  }
}

# Рассчитываем значения S_n по формуле S_n = (1 + rho_n) * S_{n-1}
for (n in 2:(N + 1)) {
  S[n] <- (1 + rho[n - 1]) * S[n - 1]
}

# Построим график изменения S_n
plot(0:N, S, type = "l", col = "red", lwd = 2,
     xlab = "Период n", ylab = "Значение Sn",
     main = "Изменение цены акции S_n при случайных доходностях")
grid()  # Добавляем сетку для удобства восприятия

